<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Historial de Viajes | TuRemis</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body {
      background: #f5f7fa;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    .header {
      background: linear-gradient(135deg, #000 0%, #333 100%);
      color: #fff;
      padding: 24px;
      margin-bottom: 24px;
    }
    .trip-card {
      background: #fff;
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: transform 0.2s;
    }
    .trip-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    .trip-date {
      font-size: 12px;
      color: #666;
      margin-bottom: 12px;
    }
    .trip-route {
      display: flex;
      align-items: start;
      gap: 12px;
      margin-bottom: 12px;
    }
    .route-icon {
      color: #10b981;
      font-size: 20px;
    }
    .trip-amount {
      font-size: 24px;
      font-weight: 800;
      color: #10b981;
    }
    .stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      margin-bottom: 24px;
    }
    .stat-card {
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
    }
    .stat-value {
      font-size: 32px;
      font-weight: 800;
      color: #000;
    }
    .stat-label {
      font-size: 14px;
      color: #666;
    }
    
    /* Mini gr√°fico */
    .mini-chart {
      display: flex;
      align-items: flex-end;
      gap: 4px;
      height: 60px;
      margin-top: 20px;
    }
    .chart-bar {
      flex: 1;
      background: linear-gradient(180deg, #10b981 0%, #059669 100%);
      border-radius: 4px 4px 0 0;
      transition: all 0.3s;
      cursor: pointer;
      position: relative;
    }
    .chart-bar:hover {
      opacity: 0.8;
      transform: scaleY(1.05);
    }
    .chart-bar::after {
      content: attr(data-value);
      position: absolute;
      top: -25px;
      left: 50%;
      transform: translateX(-50%);
      background: #000;
      color: #fff;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 11px;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s;
    }
    .chart-bar:hover::after {
      opacity: 1;
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="container">
      <h1 style="margin: 0; font-size: 28px; font-weight: 800;">üìä Historial de Viajes</h1>
      <p style="margin: 8px 0 0 0; opacity: 0.8;">Todos tus viajes realizados</p>
    </div>
  </div>
  
  <div class="container">
    <!-- Mini gr√°fico de √∫ltimos 7 d√≠as -->
    <div style="background: #fff; padding: 20px; border-radius: 16px; margin-bottom: 24px;">
      <h3 style="margin: 0 0 16px 0; font-size: 18px; font-weight: 700;">√öltimos 7 d√≠as</h3>
      <div class="mini-chart" id="miniChart"></div>
      <div style="display: flex; justify-content: space-between; margin-top: 8px; font-size: 12px; color: #666;">
        <span>Lun</span><span>Mar</span><span>Mi√©</span><span>Jue</span><span>Vie</span><span>S√°b</span><span>Dom</span>
      </div>
    </div>
    
    <!-- Estad√≠sticas -->
    <div class="stats">
      <div class="stat-card">
        <div class="stat-value" id="totalTrips">0</div>
        <div class="stat-label">Viajes totales</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" style="color: #10b981;">$<span id="totalEarnings">0</span></div>
        <div class="stat-label">Ganancias</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" style="color: #fbbf24;">‚≠ê <span id="avgRating">5.0</span></div>
        <div class="stat-label">Rating promedio</div>
      </div>
    </div>
    
    <!-- Lista de viajes -->
    <div id="tripsList"></div>
  </div>
  
  <script>
    // Generar mini gr√°fico
    function generateMiniChart() {
      const miniChart = document.getElementById('miniChart');
      // Datos demo de √∫ltimos 7 d√≠as (en producci√≥n vendr√≠a de API)
      const dailyEarnings = [800, 1200, 950, 1500, 700, 1300, 1100];
      const maxEarning = Math.max(...dailyEarnings);
      
      dailyEarnings.forEach(earning => {
        const bar = document.createElement('div');
        const height = (earning / maxEarning) * 100;
        bar.className = 'chart-bar';
        bar.style.height = `${height}%`;
        bar.setAttribute('data-value', `$${earning}`);
        miniChart.appendChild(bar);
      });
    }
    
    // Cargar viajes del localStorage
    function loadHistory() {
      const today = new Date().toDateString();
      const yesterday = new Date(Date.now() - 86400000).toDateString();
      
      // Demo data (en producci√≥n vendr√≠a de API)
      const trips = JSON.parse(localStorage.getItem('tripHistory') || '[]');
      
      if (trips.length === 0) {
        // Demo data
        trips.push(
          { date: Date.now(), from: 'San Mart√≠n 126', to: 'Av. Alem 500', amount: 850, rating: 5, tip: 100 },
          { date: Date.now() - 3600000, from: 'Centro', to: 'Hospital', amount: 600, rating: 4, tip: 0 },
          { date: Date.now() - 86400000, from: 'Estaci√≥n', to: 'Universidad', amount: 750, rating: 5, tip: 50 }
        );
      }
      
      // Calcular stats
      document.getElementById('totalTrips').textContent = trips.length;
      const totalEarnings = trips.reduce((sum, t) => sum + t.amount + (t.tip || 0), 0);
      document.getElementById('totalEarnings').textContent = totalEarnings;
      const avgRating = (trips.reduce((sum, t) => sum + (t.rating || 5), 0) / trips.length).toFixed(1);
      document.getElementById('avgRating').textContent = avgRating;
      
      // Renderizar lista
      const list = document.getElementById('tripsList');
      list.innerHTML = trips.map(trip => {
        const tripDate = new Date(trip.date);
        const dateStr = tripDate.toDateString() === today ? 'Hoy' : 
                        tripDate.toDateString() === yesterday ? 'Ayer' :
                        tripDate.toLocaleDateString();
        const timeStr = tripDate.toLocaleTimeString('es-AR', { hour: '2-digit', minute: '2-digit' });
        
        return `
          <div class="trip-card">
            <div class="trip-date">${dateStr} - ${timeStr}</div>
            <div class="trip-route">
              <i class="bi bi-geo-alt-fill route-icon"></i>
              <div style="flex: 1;">
                <div style="font-weight: 600; margin-bottom: 4px;">${trip.from}</div>
                <div style="font-size: 14px; color: #666;">‚Üì</div>
                <div style="font-weight: 600; margin-top: 4px;">${trip.to}</div>
              </div>
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <div class="trip-amount">$${trip.amount + (trip.tip || 0)}</div>
              <div>${'‚≠ê'.repeat(trip.rating || 5)}</div>
            </div>
            ${trip.tip ? `<div style="font-size: 12px; color: #10b981; margin-top: 8px;">+ $${trip.tip} propina</div>` : ''}
          </div>
        `;
      }).join('');
    }
    
    generateMiniChart();
    loadHistory();
  </script>
</body>
</html>
